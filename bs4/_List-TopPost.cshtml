@inherits Custom.Hybrid.Razor12
@using ToSic.Razor.Blade;
@{
  var helpers = CreateInstance("Links.cs");

  // This config is for the toolbar used on an item.
  var toolbarConfig = new [] {
    "-layout",                                        // hide 'layout' button
    "%new&show=true?contentType=BlogPost&entityId=0", // 'new' should show for the type BlogPost
    "%delete&show=true"                               // also force-show 'delete'
  };

  // todo: sync effect with gallery? grow instead of darken
  // todo: update all css-class names to be app-bl5-...
}
@* If no Details-page is configured, show warning to Admin *@
@if(Edit.Enabled && !Text.Has(Settings.DetailsPage)) {
  <div class="alert alert-danger" role="alert">@Html.Raw(@Resources.LabelAdminDetailPageWarning)</div>
}

<section class="app-blog" @Edit.TagToolbar(Content)>
  @* todo: @2ro - probably merge div/h1 ? *@
  <div class="category-header">
    <h1>@Content.Title</h1>
  </div>

  @* List the posts in 3 columns *@
  <div class="row card-deck">
    @foreach (var post in AsList(Data["Posts"])) {
      var imageUrl = Text.Has(post.Image) ? post.Image : Resources.PlaceholderMissingImage;

      <article class="list-item col-12 col-md-6 col-lg-4" @Edit.TagToolbar(post, toolbar: toolbarConfig)>
        <div class="app-blog-readmorelink card m-0">
          <a class="link-overlay" href="@helpers.LinkToDetailsPage(post)"></a>

          @* Image of the post *@
          @Html.Partial("_Part Main Image.cshtml", new { Post = post, Settings = Settings.Images.BlogCards })

          <div class="card-body d-flex flex-column">
            <h5 class="card-title">@post.Title</h5>
            <p class="card-text text">@Html.Raw(Tags.Strip(post.Teaser))</p>
          </div>
          <div class="card-footer">
            <span class="readmore btn btn-outline-primary float-right">@Resources.ReadMore</span>
          </div>
        </div>
      </article>
    }
  </div>

  @* Show pagination if configured *@
  @if (Content.ShowPagination != null && Content.ShowPagination) {
    @Html.Partial("_Part List Paging.cshtml")
  }
</section>

@Html.Partial("_Part Assets.cshtml")
