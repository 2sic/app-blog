@inherits Custom.Hybrid.Razor12
@{
  var isLoggedIn = CmsContext.User.Id > 0;
  var isReply = DynamicModel.IsReply ?? false;
  var isFirstComment = DynamicModel.IsFirstComment ?? false;
}

<div class='row mb-4' @(isReply ? "app-blog5-reply-form-wrapper" : "")>
  <div class="col-auto">
    @* Profile picture *@
    <div class="rounded-circle" style="height: 64px; width: 64px;">
      <img class="img-fluid rounded-circle" src='@(CmsContext.Site.Url + "/" + "/DnnImageHandler.ashx?mode=profilepic&userId=" + CmsContext.User.Id)'>
    </div>
  </div>
  <div class="col" @(isReply ? "app-blog5-reply-form" : "app-blog5-discussion-form") novalidate="true">
    @* Comment inputs *@
    @if (!isLoggedIn) {
      <div class="form-group mb-2">
        @* Pseudonym input *@
        <input class="form-control" 
          app-blog5-discussion-pseudonym 
          minlength="3" 
          placeholder="@Resources.PlaceholderNameInput" 
          required 
          data-pristine-minlength-message='@Resources.MessageMinLength.Replace("[minlength]", "3")' 
          data-pristine-required-message="@Resources.MessageNameRequired">
      </div>
    }
    <div class="form-group mb-3">
      @* Content input *@
      <textarea class="form-control comment-message" 
        app-blog5-discussion-content minlength="5" 
        placeholder="@(isFirstComment ? Resources.PlaceholderStartDiscussion : Resources.PlaceholderJoinDiscussion)" 
        required
        data-pristine-minlength-message='@Resources.MessageMinLength.Replace("[minlength]", "5")' 
        data-pristine-required-message="@Resources.MessageCommentRequired" 
      ></textarea>
    </div>
    <div class="container-fluid px-0">
      <div class="row justify-content-between align-items-center">
        <div class="col-auto">
          @* Submit buttons *@
          @if (isReply) {
            <button 
              class="btn btn-outline-primary me-2 mb-2" 
              app-blog5-submit-reply-button
              type="button"
            >
              @(isLoggedIn ? Resources.Reply : Resources.ReplyAsGuest)
            </button>
            <button 
              class="btn btn-outline-secondary me-2 mb-2"
              app-blog5-cancel-reply-button 
              type="button"
            >
              @Resources.Cancel
            </button>
          } else {
            <button 
              class="btn btn-outline-primary me-2"
              app-blog5-submit-comment-button 
              type="button" 
            >
              @(isLoggedIn ? Resources.Comment : Resources.CommentAsGuest)
            </button>
          }
        </div>
        @if (!isLoggedIn) {
          <div class="col-auto">
            <span>
              @Resources.LabelOr 
              <a href="@CmsContext.Site.Url/Login?returnUrl=@Link.To(parameters: CmsContext.Page.Parameters)">
                @Resources.Login
              </a>
            </span>
          </div>
        }
      </div>
    </div>
  </div>
</div>